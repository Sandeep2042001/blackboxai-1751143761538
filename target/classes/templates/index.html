<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
    <title>Bling Bag - Bollywood Inspired Fashion Store</title>
</head>
<body>
    <main layout:fragment="content">
        <!-- Hero Section with Sale Timer -->
        <section class="relative bg-primary text-white py-4">
            <div class="container mx-auto px-4">
                <div class="text-center">
                    <h2 class="text-2xl font-bold mb-2">Get Flat 70% On Kundan Necklace Set</h2>
                    <div class="flex justify-center items-center space-x-4" id="saleTimer">
                        <div class="text-center">
                            <span class="block text-3xl font-bold" id="days">01</span>
                            <span class="text-sm">Days</span>
                        </div>
                        <span class="text-3xl">:</span>
                        <div class="text-center">
                            <span class="block text-3xl font-bold" id="hours">09</span>
                            <span class="text-sm">Hours</span>
                        </div>
                        <span class="text-3xl">:</span>
                        <div class="text-center">
                            <span class="block text-3xl font-bold" id="minutes">33</span>
                            <span class="text-sm">Minutes</span>
                        </div>
                        <span class="text-3xl">:</span>
                        <div class="text-center">
                            <span class="block text-3xl font-bold" id="seconds">44</span>
                            <span class="text-sm">Seconds</span>
                        </div>
                    </div>
                    <a href="/collections/kundan-necklace-sets" 
                       class="inline-block mt-4 px-8 py-3 bg-accent text-primary font-semibold rounded-full hover:bg-gray-200 transition duration-300">
                        Shop now
                    </a>
                </div>
            </div>
        </section>

        <!-- Featured Categories Grid -->
        <section class="py-12">
            <div class="container mx-auto px-4">
                <h2 class="text-2xl font-bold mb-8 text-center">Shop By Category</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div th:each="category : ${featuredCategories}" class="group relative">
                        <a th:href="@{'/product/category/' + ${category.id}}">
                            <img th:src="${category.imageUrl}" th:alt="${category.name}" 
                                 class="w-full h-80 object-cover rounded-lg">
                            <div class="absolute inset-0 bg-black bg-opacity-40 group-hover:bg-opacity-50 transition duration-300 rounded-lg"></div>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <h3 class="text-white text-2xl font-bold" th:text="${category.name}">Category Name</h3>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- New Arrivals -->
        <section class="py-12 bg-gray-50">
            <div class="container mx-auto px-4">
                <h2 class="text-2xl font-bold mb-8 text-center">New Arrivals</h2>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div th:each="product : ${newArrivals}" class="group">
                        <div class="relative">
                            <a th:href="@{'/product/' + ${product.id}}">
                                <img th:src="${product.imageUrl}" th:alt="${product.name}" 
                                     class="w-full h-64 object-cover rounded-lg">
                                <div class="absolute inset-0 bg-black opacity-0 group-hover:opacity-10 transition duration-300 rounded-lg"></div>
                            </a>
                            <button class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-primary text-white px-6 py-2 rounded-full opacity-0 group-hover:opacity-100 transition duration-300"
                                    th:onclick="'addToCart(' + ${product.id} + ')'">
                                Add to Cart
                            </button>
                        </div>
                        <div class="mt-4 text-center">
                            <h3 class="text-lg font-medium" th:text="${product.name}">Product Name</h3>
                            <div class="mt-1">
                                <span class="text-lg font-bold" th:text="'₹' + ${product.discountedPrice}">₹999</span>
                                <span class="text-sm text-gray-500 line-through ml-2" 
                                      th:if="${product.price != product.discountedPrice}"
                                      th:text="'₹' + ${product.price}">₹1999</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-8">
                    <a href="/product/new-arrivals" 
                       class="inline-block px-8 py-3 bg-primary text-white font-semibold rounded-full hover:bg-gray-800 transition duration-300">
                        View All New Arrivals
                    </a>
                </div>
            </div>
        </section>

        <!-- Featured Products -->
        <section class="py-12">
            <div class="container mx-auto px-4">
                <h2 class="text-2xl font-bold mb-8 text-center">Featured Products</h2>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div th:each="product : ${featuredProducts}" class="group">
                        <div class="relative">
                            <a th:href="@{'/product/' + ${product.id}}">
                                <img th:src="${product.imageUrl}" th:alt="${product.name}" 
                                     class="w-full h-64 object-cover rounded-lg">
                                <div class="absolute inset-0 bg-black opacity-0 group-hover:opacity-10 transition duration-300 rounded-lg"></div>
                            </a>
                            <button class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-primary text-white px-6 py-2 rounded-full opacity-0 group-hover:opacity-100 transition duration-300"
                                    th:onclick="'addToCart(' + ${product.id} + ')'">
                                Add to Cart
                            </button>
                        </div>
                        <div class="mt-4 text-center">
                            <h3 class="text-lg font-medium" th:text="${product.name}">Product Name</h3>
                            <div class="mt-1">
                                <span class="text-lg font-bold" th:text="'₹' + ${product.discountedPrice}">₹999</span>
                                <span class="text-sm text-gray-500 line-through ml-2" 
                                      th:if="${product.price != product.discountedPrice}"
                                      th:text="'₹' + ${product.price}">₹1999</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-8">
                    <a href="/product/featured" 
                       class="inline-block px-8 py-3 bg-primary text-white font-semibold rounded-full hover:bg-gray-800 transition duration-300">
                        View All Featured Products
                    </a>
                </div>
            </div>
        </section>

        <!-- Shop by Collection -->
        <section class="py-12 bg-gray-50">
            <div class="container mx-auto px-4">
                <h2 class="text-2xl font-bold mb-8 text-center">Shop by Collection</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div th:each="category : ${mainCategories}" class="group relative">
                        <a th:href="@{'/product/category/' + ${category.id}}">
                            <img th:src="${category.imageUrl}" th:alt="${category.name}" 
                                 class="w-full h-96 object-cover rounded-lg">
                            <div class="absolute inset-0 bg-black bg-opacity-40 group-hover:bg-opacity-50 transition duration-300 rounded-lg"></div>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <div class="text-center">
                                    <h3 class="text-white text-2xl font-bold mb-2" th:text="${category.name}">Collection Name</h3>
                                    <span class="inline-block px-6 py-2 bg-white text-primary font-semibold rounded-full">
                                        Shop Now
                                    </span>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Additional Scripts -->
    <th:block layout:fragment="scripts">
        <script th:inline="javascript">
            // Sale Timer
            function updateTimer() {
                const endDate = new Date('2025-06-29T23:59:00');
                const now = new Date();
                const diff = endDate - now;

                if (diff > 0) {
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                    document.getElementById('days').textContent = String(days).padStart(2, '0');
                    document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                    document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                    document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
                }
            }

            setInterval(updateTimer, 1000);
            updateTimer();

            // Add to Cart Function
            function addToCart(productId) {
                fetch('/cart/add', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `productId=${productId}&quantity=1`
                })
                .then(response => response.json())
                .then(data => {
                    if (data.message) {
                        // Update cart count
                        const cartCount = document.querySelector('.cart-count');
                        if (cartCount) {
                            cartCount.textContent = data.cartItemCount;
                        }
                        // Show success message
                        alert('Product added to cart successfully');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error adding product to cart');
                });
            }
        </script>
    </th:block>
</body>
</html>
